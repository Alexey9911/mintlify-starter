---
title: "Anti-Phishing Protection"
description: "Real-time URL scanning and AI-powered phishing site detection"
icon: "shield-halved"
---

CryptoGuard's anti-phishing module uses multi-layered detection to identify and block malicious websites before they can compromise your wallet.

## Detection Methods

### URL Pattern Analysis

CryptoGuard analyzes URL structure for common phishing indicators:

```typescript
interface URLAnalysis {
  domain: string;
  registrationAge: number;      // Days since domain registration
  sslStatus: 'valid' | 'invalid' | 'expired' | 'self-signed';
  typosquatting: boolean;       // Similar to known legitimate domains
  homoglyphAttack: boolean;     // Uses lookalike Unicode characters
  suspiciousSubdomain: boolean; // e.g., metamask.login.phishing.com
  redirectChain: string[];      // Full redirect path
}
```

### Known Phishing Database

We maintain a real-time updated database of confirmed phishing sites:

| Database | Update Frequency | Coverage |
|----------|------------------|----------|
| CryptoGuard Internal | Real-time | 150,000+ domains |
| PhishTank | 15 minutes | General phishing |
| OpenPhish | 30 minutes | Targeted attacks |
| ChainGPT Threat Intel | Real-time | Web3-specific |

### AI Content Analysis

Our ML model analyzes page content for phishing characteristics:

```typescript
interface ContentAnalysis {
  seedPhraseRequest: boolean;   // Asks for recovery phrase
  privateKeyRequest: boolean;   // Asks for private key
  fakeWalletConnect: boolean;   // Simulated wallet connect UI
  urgencyLanguage: number;      // Score 0-100 for urgency tactics
  brandImpersonation: string[]; // Detected brand mimicry
  suspiciousFormFields: string[];
}
```

---

## Threat Response

When a phishing threat is detected, CryptoGuard responds based on confidence level:

<Steps>
  <Step title="Low Confidence (Score 30-50)">
    Warning banner displayed. User can proceed with caution.
    
    ```json
    {
      "action": "warn",
      "riskScore": 42,
      "flags": ["young_domain", "no_ssl"],
      "message": "This site has some suspicious characteristics"
    }
    ```
  </Step>
  
  <Step title="Medium Confidence (Score 50-80)">
    Interstitial warning page. User must acknowledge before proceeding.
    
    ```json
    {
      "action": "block_soft",
      "riskScore": 67,
      "flags": ["typosquatting", "suspicious_form"],
      "message": "This site appears to be impersonating a known service"
    }
    ```
  </Step>
  
  <Step title="High Confidence (Score 80-100)">
    Page blocked completely. User cannot proceed.
    
    ```json
    {
      "action": "block_hard",
      "riskScore": 94,
      "flags": ["confirmed_phishing", "seed_phrase_form"],
      "message": "This is a confirmed phishing site"
    }
    ```
  </Step>
</Steps>

---

## Technical Implementation

### URL Scanning Pipeline

```typescript
async function scanURL(url: string): Promise<ScanResult> {
  // Step 1: Quick database lookup (< 5ms)
  const dbResult = await checkBlacklist(url);
  if (dbResult.isBlocked) {
    return { action: 'block_hard', source: 'database' };
  }

  // Step 2: URL structure analysis (< 10ms)
  const urlAnalysis = analyzeURLStructure(url);
  
  // Step 3: SSL verification (< 50ms)
  const sslStatus = await verifySSL(url);
  
  // Step 4: Domain age check (< 100ms)
  const domainInfo = await queryWhois(url);
  
  // Step 5: AI content analysis (< 200ms)
  const contentScore = await analyzePageContent(url);
  
  // Aggregate scores
  const riskScore = calculateRiskScore({
    urlAnalysis,
    sslStatus,
    domainInfo,
    contentScore
  });
  
  return determineAction(riskScore);
}
```

### Risk Score Calculation

| Factor | Weight | Description |
|--------|--------|-------------|
| Domain Age | 20% | Domains < 30 days are high risk |
| SSL Status | 15% | Invalid/missing SSL increases risk |
| URL Pattern | 25% | Typosquatting, homoglyphs, suspicious subdomains |
| Content Analysis | 30% | Seed phrase forms, fake wallets, brand mimicry |
| Database Match | 10% | Proximity to known phishing URLs |

<Note>
  Risk scores above 70 trigger automatic blocking. This threshold is configurable in extension settings.
</Note>

---

## Whitelisting

Add trusted domains to your personal whitelist:

```typescript
// Extension API
await cryptoguard.whitelist.add({
  domain: 'app.uniswap.org',
  reason: 'Official Uniswap frontend'
});

// View whitelist
const whitelist = await cryptoguard.whitelist.list();
// Returns: ['app.uniswap.org', 'pancakeswap.finance', ...]
```

<Warning>
  Whitelisted domains bypass all scanning. Only whitelist domains you trust completely. CryptoGuard is not responsible for losses from whitelisted domains.
</Warning>

---

## Reporting False Positives

If a legitimate site is incorrectly blocked:

1. Click **Report False Positive** in the block page
2. Submit the URL for review
3. Our team reviews within 24 hours
4. If confirmed legitimate, site is added to global whitelist

```typescript
await cryptoguard.report({
  url: 'https://legitimate-site.com',
  type: 'false_positive',
  details: 'Official site for X protocol'
});
```

---

## Statistics

| Metric | Value |
|--------|-------|
| Phishing Sites Blocked | 847,000+ |
| False Positive Rate | <0.01% |
| Average Detection Time | 23ms |
| Database Updates | Every 15 seconds |
